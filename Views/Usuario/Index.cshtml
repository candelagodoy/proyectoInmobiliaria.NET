@model IEnumerable<proyectoInmobiliaria.NET.Models.Usuario>

@{
    ViewData["Title"] = "Usuarios";
}

<div class="container-xxl py-3">
    <div class="card shadow-sm">
        <div class="card-header bg-info text-white d-flex justify-content-between align-items-center">
            <h1 class="h4 mb-0 fw-semibold">Usuarios</h1>
            @if (User.IsInRole("Administrador"))
            {
                <a class="btn btn-light btn-sm fw-semibold" asp-action="Create">
                    <i class="bi bi-person-plus"></i> Agregar Usuario
                </a>
            }
        </div>

        <div class="card-body p-0">
            <div class="table-responsive">
                <table class="table table-striped table-hover align-middle mb-0">
                    <thead class="bg-light">
                        <tr class="text-uppercase small text-secondary">
                            <th>@Html.DisplayNameFor(model => model.idUsuario)</th>
                            <th>@Html.DisplayNameFor(model => model.nombre)</th>
                            <th>@Html.DisplayNameFor(model => model.apellido)</th>
                            <th>@Html.DisplayNameFor(model => model.email)</th>
                            <th>@Html.DisplayNameFor(model => model.rol)</th>
                            <th>@Html.DisplayNameFor(model => model.avatar)</th>
                            <th class="text-center">Acciones</th>
                        </tr>
                    </thead>
                    <tbody>
                        @foreach (var item in Model)
                        {
                            <tr>
                                <td>@Html.DisplayFor(modelItem => item.idUsuario)</td>
                                <td>@Html.DisplayFor(modelItem => item.nombre)</td>
                                <td>@Html.DisplayFor(modelItem => item.apellido)</td>
                                <td>@Html.DisplayFor(modelItem => item.email)</td>
                                <td>@Html.DisplayFor(modelItem => item.rolNombre)</td>
                                <td>
                                    <img src="@item.avatar" alt="Sin avatar" width="50" height="64" class="rounded border" />
                                </td>
                                <td class="text-center">
                                    <div class="btn-group" role="group">
                                        <a class="btn btn-primary" 
                                           asp-action="Details" 
                                           asp-route-id="@item.idUsuario" 
                                           title="Perfil">
                                           Perfil
                                        </a>

                                        @if (User.IsInRole("Administrador"))
                                        {
                                            <a class="btn btn-secondary" 
                                               asp-action="Edit" 
                                               asp-controller="Usuario" 
                                               asp-route-id="@item.idUsuario" 
                                               title="Editar">
                                               Editar
                                            </a>

                                            <a class="btn btn-danger" 
                                               asp-action="Delete" 
                                               asp-route-id="@item.idUsuario" 
                                               title="Eliminar">
                                               Eliminar
                                            </a>
                                        }
                                    </div>
                                </td>
                            </tr>
                        }
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>
